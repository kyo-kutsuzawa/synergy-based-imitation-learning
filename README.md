# Synergy-based Imitation Learning

## Data collection

Collect demonstrations using Intel RealSense:

```bash
python src/record/collect_demonstration.py
```

Preprocess the demonstrations:

```bash
python src/record/convert.py dataset/realsense dataset/data_preprocessed
```

Visualize preprocessed demonstrations:

```bash
python src/record/show_demonstrations.py dataset/data_preprocessed
```

## Synergy extraction

Extract synergies:

```bash
python src/synergy_extraction/extract.py dataset/data_preprocessed_train dataset/train
python src/synergy_extraction/extract.py dataset/data_preprocessed_validation dataset/validation --load dataset/train/synergy.npy
```

Compute reconstruction performance:

```bash
python src/synergy_extraction/compute_reconstruction_performance.py dataset/all
```

Visualize the extracted synergies:

```bash
python src/synergy_extraction/show_synergy.py dataset/train/synergy.npy
```

Visualize the synergy activities in the demonstrations:

```bash
python src/synergy_extraction/show_activity.py dataset/all
```

## Training

Train an NN with the proposed method:

```bash
python src/nn/train.py proposed --gpu 0 --n-layers 1 --n-units 256 --lr 0.00005 --alpha 0.1
```

Train an NN with the baseline method:

```bash
python src/nn/train.py baseline --gpu 0 --n-layers 3 --n-units 256 --lr 0.001
```

## Evaluation of the trained model

Generate trajectories by autoregression:

```bash
python src/nn/evaluate.py result/nn_latest.pth
```

Compute success rate:

```bash
python src/nn/classify.py result/autoregression/
```

## Deploy the trained model for robot control

Apply to robot control

```bash
python src/nn/communicate.py result/nn_latest.pth --letters jjj
```

Visualize trajectories generated by the trained NN:

```bash
python src/experiment/show_trajectory.py experimental_result/
```

Visualize the synergy activities generated by the trained NN:

```bash
python src/experiment/show_activity.py experimental_result/
```
